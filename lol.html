<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>3D Cake Cutter • Happy Anniversary</title>
<style>
  :root{
    --cake-size: 380px;
    --gap: 22px;      /* slice gap when cut */
    --fan: 26px;      /* outward fan distance */
    --depth: 60px;    /* cake height (3D thickness) */
    --bg1: #fff3f7;
    --bg2: #fffbe7;
    --ink: #222;

    /* Cake palette */
    --sponge: #f4cfa2;
    --cream: #fff6fb;
    --jam: #ff5b82;
    --icing: #fde0f0;
    --shadow: #00000025;

    --plate: #d9e3ff;
    --candle: #ffffff;
    --flame: #ffd24d;
  }

  *{box-sizing:border-box}

  body{
    margin:0;
    min-height:100svh;
    display:grid;
    place-items:center;
    background: radial-gradient(1200px 1200px at 50% -30%, var(--bg2), var(--bg1));
    font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
    color: var(--ink);
    overflow:hidden;
  }

  .app{
    display:grid;
    gap:18px;
    place-items:center;
    padding:20px;
  }
  h1{ margin:0; font-size:22px; }

  /* 3D scene */
  .stage{
    position:relative;
    width:min(92vw, 600px);
    height:min(92vw, 600px);
    display:grid;
    place-items:center;
    perspective: 1000px;            /* 3D perspective */
    overflow:visible;
  }

  .scene{
    position:relative;
    transform-style: preserve-3d;   /* enable children 3D */
    transform: rotateX(14deg);      /* slight tilt for 3D feel */
  }

  /* Celebration layer */
  .celebrate{
    position:absolute; inset:-10vh -10vw; display:grid; place-items:center;
    pointer-events:none; opacity:0; transition:opacity .5s ease .1s;
  }
  .celebrate.active{ opacity:1; }
  .confetti{ position:absolute; inset:0; overflow:hidden; z-index:0; }
  .confetti span{
    position:absolute; width:8px; height:14px; border-radius:2px;
    background: hsl(var(--h) 80% 60%);
    left: var(--x); top: -20px; transform: rotate(var(--r));
    animation: fall linear var(--d) var(--delay) infinite;
    box-shadow: 0 0 0 1px #00000010 inset; opacity:.85;
  }
  @keyframes fall{
    0%{ transform: translateY(-30px) rotate(var(--r)) }
    60%{ transform: translateY(60vh) rotate(calc(var(--r) + 360deg)) }
    100%{ transform: translateY(90vh) rotate(calc(var(--r) + 540deg)) }
  }
  .anniversary{
    position:relative; z-index:1; text-align:center; font-weight:700;
    font-size: clamp(22px, 6vw, 48px); color:#b3204a;
    text-shadow: 0 1px 0 #fff, 0 6px 22px #00000016;
    letter-spacing:1px; transform: translateY(-8%);
    filter: drop-shadow(0 8px 24px var(--shadow));
  }

  /* Plate under cake (3D) */
  .plate{
    position:absolute; left:50%; top: calc(50% + var(--depth));
    width: clamp(260px, 70vmin, 500px);
    height: clamp(20px, 4vmin, 40px);
    transform: translate(-50%, -50%) rotateX(90deg);
    border-radius: 50%;
    background: radial-gradient(closest-side, #eef3ff, var(--plate));
    box-shadow: 0 16px 40px var(--shadow);
    transform-style: preserve-3d;
  }

  /* Cake container (3D stack) */
  .cake-wrap{
    position:relative;
    width: var(--cake-size);
    height: var(--cake-size);
    transform-style: preserve-3d;
    filter: drop-shadow(0 18px 32px var(--shadow));
  }

  /* Slices: each is a vertical slab (extruded wedge) */
  .slice{
    position:absolute; inset:0; border-radius:50%;
    transform-style: preserve-3d;
    transition: transform .7s cubic-bezier(.2,.8,.2,1);
    filter: drop-shadow(0 6px 12px var(--shadow));
  }

  /* Top face of slice (the circular wedge) */
  .slice .top{
    position:absolute; inset:0; border-radius:50%;
    clip-path: var(--wedge);
    background:
      /* sprinkles */
      radial-gradient(6px 6px at 70% 28%, #ff7da3 98%, #0000 100%),
      radial-gradient(6px 6px at 36% 42%, #7ad3ff 98%, #0000 100%),
      radial-gradient(6px 6px at 64% 62%, #ffd05a 98%, #0000 100%),
      radial-gradient(6px 6px at 28% 68%, #a5ff7a 98%, #0000 100%),

      /* icing top */
      radial-gradient(closest-side, var(--icing) 62%, #0000 62.5%) top/100% 100% no-repeat,

      /* jam ring */
      radial-gradient(closest-side, var(--jam) 56%, #0000 56.5%) top/100% 100% no-repeat,

      /* sponge base (bigger than jam) */
      radial-gradient(closest-side, var(--sponge) 74%, #0000 74.5%) top/100% 100% no-repeat;
    transform: translateZ(var(--depth));
    box-shadow: 0 0 0 1px #f2c7a0 inset;
  }

  /* Side walls of slice: simulate cylinder with layered bands */
  .slice .side{
    position:absolute; inset:0; border-radius:50%;
    clip-path: var(--wedge);
    background:
      linear-gradient(#e6b67c, #d9a769) 0 0/100% 100% no-repeat; /* base wall color behind bands */
    transform: translateZ(0);
  }
  /* Create vertical wall illusion using multiple stacked rings via box-shadow on a pseudo-element */
  .slice .side::before{
    content:"";
    position:absolute; left:50%; bottom:0; transform: translateX(-50%);
    width: 74%; height: var(--depth);
    border-radius: 40%/14%;
    background:
      linear-gradient(#ffeef7, #ffd9f0); /* icing wall */
    box-shadow:
      0 8px 0 0 var(--jam) inset,
      0 22px 0 0 var(--sponge) inset,
      0 36px 0 0 var(--cream) inset;
    filter: brightness(0.98);
  }
  /* Outer rim to suggest curvature/shadow */
  .slice .rim{
    position:absolute; inset:0; border-radius:50%;
    clip-path: var(--wedge);
    background:
      radial-gradient(60% 100% at 50% 90%, #0000 60%, #00000018 100%);
    transform: translateZ(0);
  }

  /* Direction vectors for 8 slices */
  .s1{ --vx:  0;     --vy: -1; }
  .s2{ --vx:  0.707; --vy: -0.707; }
  .s3{ --vx:  1;     --vy:  0; }
  .s4{ --vx:  0.707; --vy:  0.707; }
  .s5{ --vx:  0;     --vy:  1; }
  .s6{ --vx: -0.707; --vy:  0.707; }
  .s7{ --vx: -1;     --vy:  0; }
  .s8{ --vx: -0.707; --vy: -0.707; }

  /* On cut: move outward in plane; keep Z as is */
  .cut .slice{
    transform:
      translate3d(calc(var(--vx)*(var(--gap) + var(--fan))),
                  calc(var(--vy)*(var(--gap) + var(--fan))),
                  0);
  }
  .slice.pop{
    transform:
      translate3d(calc(var(--vx)*(var(--gap) + var(--fan) + 10px)),
                  calc(var(--vy)*(var(--gap) + var(--fan) + 10px)),
                  0);
  }

  /* Candles (sit on top face) */
  .candles{
    position:absolute; left:50%; top: calc(50% - var(--cake-size)/2 + 0px);
    transform: translate(-50%, -50%) translateZ(calc(var(--depth) + 1px));
    display:flex; gap:12px; z-index:3; pointer-events:none;
  }
  .candle{
    width:8px; height:44px; background: var(--candle);
    border-radius:3px; position:relative;
    box-shadow: 0 0 0 1px #00000010 inset;
  }
  .candle::before{
    content:""; position:absolute; left:50%; top:-14px;
    width:16px; height:16px; transform: translate(-50%,0) rotate(45deg);
    background: radial-gradient(60% 60% at 40% 40%, #fff6b3, var(--flame));
    border-radius: 0 50% 50% 50%;
    animation: flicker .9s infinite alternate ease-in-out;
    filter: drop-shadow(0 2px 6px #ffd24d);
  }
  @keyframes flicker{
    0%{ transform: translate(-50%,-1px) rotate(44deg) scale(1) }
    100%{ transform: translate(-50%,-4px) rotate(46deg) scale(1.12) }
  }

  /* Knife */
  .knife{
    position:absolute; width: 180px; height: 20px;
    background: linear-gradient(90deg,#efefef,#c9c9c9 60%,#8d8d8d);
    top: 50%; left: 50%; transform-origin: left center;
    translate: -50% -50%; border-radius: 3px 3px 3px 24px;
    box-shadow: 0 2px 8px var(--shadow); opacity:0; pointer-events:none;
  }
  .cut .knife{ opacity:1; animation: sliceSweep .9s ease forwards; }
  @keyframes sliceSweep{
    0%{ rotate: -60deg } 100%{ rotate: 120deg }
  }

  /* Controls */
  .controls{ display:flex; gap:12px; flex-wrap:wrap; justify-content:center; }
  button{
    appearance:none; border:none; padding:12px 16px; background:#1e1e1e; color:#fff;
    border-radius:10px; cursor:pointer; font-weight:600;
    box-shadow: 0 8px 18px var(--shadow), 0 0 0 2px #ffffff10 inset;
    transition: transform .08s ease, background .2s ease, box-shadow .2s ease;
  }
  button:hover{ background:#2a2a2a; }
  button:active{ transform: translateY(1px) scale(0.99); }
  .secondary{ background:#e9e9e9; color:#222; }
  .secondary:hover{ background:#f2f2f2; }

  @media (max-width:480px){
    :root{ --cake-size: 300px; --gap: 16px; --fan: 18px; --depth: 48px; }
  }
</style>
</head>
<body>
  <div class="app">
    <h1>3D Cake Cutter • Happy Anniversary</h1>

    <div class="stage">
      <div class="celebrate" id="celebrate" aria-hidden="true">
        <div class="confetti" id="confetti"></div>
        <div class="anniversary">Happy Anniversary ❤️</div>
      </div>

      <div class="scene">
        <!-- Plate -->
        <div class="plate"></div>

        <!-- Cake -->
        <div class="cake-wrap" id="cakeWrap">
          <!-- 8 extruded wedges -->
          <div class="slice s1" style="--wedge: path('M 50% 50% L 100% 50% A 50% 50% 0 0 0 50% 0 Z');">
            <div class="top"></div>
            <div class="side"></div>
            <div class="rim"></div>
          </div>
          <div class="slice s2" style="--wedge: path('M 50% 50% L 100% 50% A 50% 50% 0 0 1 85.355% 14.645% Z');">
            <div class="top"></div>
            <div class="side"></div>
            <div class="rim"></div>
          </div>
          <div class="slice s3" style="--wedge: path('M 50% 50% L 85.355% 14.645% A 50% 50% 0 0 1 50% 0 Z');">
            <div class="top"></div>
            <div class="side"></div>
            <div class="rim"></div>
          </div>
          <div class="slice s4" style="--wedge: path('M 50% 50% L 85.355% 85.355% A 50% 50% 0 0 1 85.355% 14.645% Z');">
            <div class="top"></div>
            <div class="side"></div>
            <div class="rim"></div>
          </div>
          <div class="slice s5" style="--wedge: path('M 50% 50% L 50% 100% A 50% 50% 0 0 1 85.355% 85.355% Z');">
            <div class="top"></div>
            <div class="side"></div>
            <div class="rim"></div>
          </div>
          <div class="slice s6" style="--wedge: path('M 50% 50% L 14.645% 85.355% A 50% 50% 0 0 1 50% 100% Z');">
            <div class="top"></div>
            <div class="side"></div>
            <div class="rim"></div>
          </div>
          <div class="slice s7" style="--wedge: path('M 50% 50% L 0% 50% A 50% 50% 0 0 1 14.645% 85.355% Z');">
            <div class="top"></div>
            <div class="side"></div>
            <div class="rim"></div>
          </div>
          <div class="slice s8" style="--wedge: path('M 50% 50% L 14.645% 14.645% A 50% 50% 0 0 1 0% 50% Z');">
            <div class="top"></div>
            <div class="side"></div>
            <div class="rim"></div>
          </div>

          <!-- Candles on top -->
          <div class="candles" aria-hidden="true">
            <div class="candle"></div>
            <div class="candle"></div>
            <div class="candle"></div>
          </div>

          <!-- Knife -->
          <div class="knife"></div>
        </div>
      </div>
    </div>

    <div class="controls">
      <button id="cutBtn" type="button">Cut Cake</button>
      <button class="secondary" id="resetBtn" type="button">Reset</button>
    </div>
  </div>

<script>
  const cakeWrap = document.getElementById('cakeWrap');
  const cutBtn = document.getElementById('cutBtn');
  const resetBtn = document.getElementById('resetBtn');
  const celebrate = document.getElementById('celebrate');
  const confettiBox = document.getElementById('confetti');
  const slices = Array.from(document.querySelectorAll('.slice'));

  // Confetti
  function makeConfetti(count=160){
    confettiBox.innerHTML = '';
    const vw = window.innerWidth;
    for(let i=0;i<count;i++){
      const s = document.createElement('span');
      const hue = Math.floor(Math.random()*360);
      const left = Math.random()*vw + 'px';
      const rot = (Math.random()*180 - 90) + 'deg';
      const dur = (1.2 + Math.random()*1.8).toFixed(2)+'s';
      const delay = (Math.random()*0.9).toFixed(2)+'s';
      s.style.setProperty('--h', hue);
      s.style.setProperty('--x', left);
      s.style.setProperty('--r', rot);
      s.style.setProperty('--d', dur);
      s.style.setProperty('--delay', delay);
      confettiBox.appendChild(s);
    }
  }
  function celebrateOn(){ celebrate.classList.add('active'); makeConfetti(160); }
  function celebrateOff(){ celebrate.classList.remove('active'); confettiBox.innerHTML=''; }

  function cutCake(){
    cakeWrap.classList.add('cut');
    cutBtn.disabled = true;
    celebrateOn();
  }
  function resetCake(){
    cakeWrap.classList.remove('cut');
    cutBtn.disabled = false;
    celebrateOff();
    slices.forEach(s => s.classList.remove('pop'));
  }

  // Slice pop on click (after cut)
  slices.forEach(s => {
    s.addEventListener('click', () => {
      if(!cakeWrap.classList.contains('cut')) return;
      s.classList.toggle('pop');
    });
  });

  // Buttons
  cutBtn.addEventListener('click', cutCake, { passive: true });
  resetBtn.addEventListener('click', resetCake, { passive: true });

  // Keep confetti width on resize
  addEventListener('resize', () => {
    if(celebrate.classList.contains('active')) makeConfetti(160);
  });
</script>
</body>
</html>
